/* jQuery Shmack v0.1.0
 * By Matt Rose - mattrose.ca
 * Licensed MIT */
(function(t){t.shmack=function(n,e){var s={blockSelector:"li",columns:3,loadImages:!0,setImageHeight:!1,onBlockLoad:!1,complete:!1},a=this;a.settings=t.extend({},s,e);var i=t(n),o=i.find(a.settings.blockSelector),c=function(){a.columnWidth=Math.round(1e3*(100/a.settings.columns))/1e3+"%",a.columnContainers=[],a.columnHeights=[];for(var n=1;a.settings.columns>=n;n++){var e=t("<div></div>").addClass("shmack-column").attr("id","shmack-column-"+n).css({width:a.columnWidth,"float":"left"});i.append(e),a.columnContainers.push(e),a.columnHeights.push(0)}o.each(function(n){var e=t(this),s=this;if(a.settings.setImageHeight||a.settings.loadImages){var i=Math.min.apply(Math,a.columnHeights),o=a.columnHeights.indexOf(i),c=a.columnContainers[o];c.append(e),a.columnHeights[o]+=h(s)}else a.columnContainers[n%a.settings.columns].append(e);a.settings.onBlockLoad&&a.settings.onBlockLoad(n,s)}).css({width:"100%","float":"none"}),a.settings.complete&&a.settings.complete()};a.destroy=function(){o.each(function(){var n=t(this);i.append(n)}).css({width:"","float":""});for(var n;a.columnContainers.length>=n;n++)$column=a.columnContainers[n],$column.remove()};var h=function(n){var e=t(n),s=e.height();return a.settings.setImageHeight&&e.find("img").each(function(){var n=t(this);void 0!==n.data("height")&&(s+=n.data("height"),s-=n.height())}),s};a.settings.loadImages?i.imagesLoaded(c):c()},t.fn.imagesLoaded=function(n){function e(){n.call(a,i)}function s(n){var a=n.target;a.src!==c&&-1===t.inArray(a,h)&&(h.push(a),0>=--o&&(setTimeout(e),i.unbind(".imagesLoaded",s)))}var a=this,i=a.find("img").add(a.filter("img")),o=i.length,c="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",h=[];return o||e(),i.bind("load.imagesLoaded error.imagesLoaded",s).each(function(){var t=this.src;this.src=c,this.src=t}),a},t.fn.shmack=function(n){return this.each(function(){if(void 0===t(this).data("shmack")){var e=new t.shmack(this,n);t(this).data("shmack",e)}else t(this).data("shmack")[n]&&t(this).data("shmack")[n].apply(this,arguments)})}})(jQuery);